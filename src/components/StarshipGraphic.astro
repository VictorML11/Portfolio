---
// src/components/StarshipGraphic.astro
---

<div class="w-full h-full">
    <svg
        viewBox="0 0 100 100"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        class="w-full h-full overflow-visible"
    >
        <defs>
            <linearGradient
                id="ship-grad"
                x1="0"
                y1="0"
                x2="100"
                y2="100"
                gradientUnits="userSpaceOnUse"
            >
                <stop offset="0%" stop-color="#22d3ee"></stop>
                <stop offset="100%" stop-color="#a78bfa"></stop>
            </linearGradient>

            <filter
                id="glow-engine"
                x="-50%"
                y="-50%"
                width="200%"
                height="200%"
            >
                <feGaussianBlur stdDeviation="2" result="coloredBlur"
                ></feGaussianBlur>
                <feMerge>
                    <feMergeNode in="coloredBlur"></feMergeNode>
                    <feMergeNode in="SourceGraphic"></feMergeNode>
                </feMerge>
            </filter>
        </defs>

        <g class="exhaust opacity-80">
            <line
                x1="22"
                y1="50"
                x2="22"
                y2="10"
                class="trail-fast"
                style="--x: 22px; --y: 50px; --delay:0s"></line>
            <line
                x1="22"
                y1="50"
                x2="18"
                y2="20"
                class="trail-side"
                style="--x: 22px; --y: 50px; --delay:0.1s"></line>

            <line
                x1="78"
                y1="50"
                x2="78"
                y2="10"
                class="trail-fast"
                style="--x: 78px; --y: 50px; --delay:0.2s"></line>
            <line
                x1="78"
                y1="50"
                x2="82"
                y2="20"
                class="trail-side"
                style="--x: 78px; --y: 50px; --delay:0.3s"></line>

            <circle
                cx="22"
                cy="30"
                r="1.5"
                class="particle"
                style="--x: 22px; --y: 50px; --delay:0s"></circle>
            <circle
                cx="78"
                cy="30"
                r="1.5"
                class="particle"
                style="--x: 78px; --y: 50px; --delay:0.4s"></circle>
        </g>

        <g class="ship" style="filter: url(#glow-engine);">
            <path
                d="M 22 50 L 50 75"
                stroke="url(#ship-grad)"
                stroke-width="2"
                stroke-linecap="round"></path>
            <path
                d="M 78 50 L 50 75"
                stroke="url(#ship-grad)"
                stroke-width="2"
                stroke-linecap="round"></path>
            <path
                d="M 32 44 L 50 29 L 68 44"
                stroke="#22d3ee"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"></path>
        </g>
    </svg>
</div>

<style>
    /* Physics: Particles move UP (negative Y) away from the ship moving DOWN */
    @keyframes blast {
        0% {
            transform: translate(0, 0);
            opacity: 1;
            stroke-width: 2;
        }
        100% {
            transform: translate(0, -40px);
            opacity: 0;
            stroke-width: 0;
        }
    }

    @keyframes drift {
        0% {
            transform: translate(0, 0) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(var(--rn-x, 0px), -60px) scale(0);
            opacity: 0;
        }
    }

    .trail-fast {
        stroke: #22d3ee;
        stroke-dasharray: 5 5;
        animation: blast 0.4s linear infinite;
        transform-origin: var(--x) var(--y);
    }

    .trail-side {
        stroke: #c084fc;
        opacity: 0.6;
        animation: blast 0.6s linear infinite;
        animation-delay: var(--delay);
        transform-origin: var(--x) var(--y);
    }

    .particle {
        fill: white;
        animation: drift 1s ease-out infinite;
        animation-delay: var(--delay);
        transform-box: fill-box;
        transform-origin: center;
    }
</style>
